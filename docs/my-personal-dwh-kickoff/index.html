<!DOCTYPE html>
<!--[if lt IE 7]> <html class="no-js lt-ie9 lt-ie8 lt-ie7"> <![endif]-->
<!--[if IE 7]> <html class="no-js lt-ie9 lt-ie8"> <![endif]-->
<!--[if IE 8]> <html class="no-js lt-ie9"> <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js"> <!--<![endif]-->
<head>
  <meta http-equiv="content-type" content="text/html; charset=utf-8">
  <title>My Personal Data Warehouse Kickoff  &middot; Lubolab</title>
  <meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="HandheldFriendly" content="True">
<meta name="MobileOptimized" content="320">
<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="description" content="" />

<meta name="keywords" content="Personal DWH, ">


<meta property="og:title" content="My Personal Data Warehouse Kickoff  &middot; Lubolab ">
<meta property="og:site_name" content="Lubolab"/>
<meta property="og:url" content="https://lubolab.com/my-personal-dwh-kickoff/" />
<meta property="og:locale" content="en">


<meta property="og:type" content="article" />
<meta property="og:description" content=""/>
<meta property="og:article:published_time" content="2017-01-12T03:57:28&#43;02:00" />
<meta property="og:article:modified_time" content="2017-01-12T03:57:28&#43;02:00" />

  
    
<meta property="og:article:tag" content="Personal DWH">
    
  

  
<meta name="twitter:card" content="summary" />
<meta name="twitter:site" content="@LubomirKamensky" />
<meta name="twitter:creator" content="@LubomirKamensky" />
<meta name="twitter:title" content="My Personal Data Warehouse Kickoff" />
<meta name="twitter:description" content="" />
<meta name="twitter:url" content="https://lubolab.com/my-personal-dwh-kickoff/" />
<meta name="twitter:domain" content="https://lubolab.com/">
  

  



<link rel="canonical" href="https://lubolab.com/my-personal-dwh-kickoff/" />
<link rel="apple-touch-icon-precomposed" sizes="144x144" href="https://lubolab.com/touch-icon-144-precomposed.png">
<link rel="icon" href="https://lubolab.com/favicon.png">
<meta name="generator" content="Hugo 0.25.1" />

  <!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/libs/html5shiv/3.7.2/html5shiv.js"></script>
<script src="https://oss.maxcdn.com/libs/respond.js/1.4.2/respond.min.js"></script>
<![endif]-->



    <link rel="stylesheet" href="https://lubolab.com/css/bootswatch/paper/bootstrap.min.css">


<link rel="stylesheet" href="https://lubolab.com/css/font-awesome.min.css">
<link rel="stylesheet" href="https://lubolab.com/css/style.css">


<link rel="stylesheet" href="https://lubolab.com/css/style_custom.css">



  <link rel="stylesheet" href="https://lubolab.com/css/highlight/default.css">


</head>
<body class="map[name:paper]" data-ng-app="myapp" data-ng-controller="MyController" data-ng-mouseleave="MouseLeave($event)">
    <header id="main-header">
  <nav class="navbar navbar-default navbar-fixed-top">
    <div class="container">
      <div class="navbar-header">
        <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false" aria-controls="navbar">
          <span class="sr-only">Toggle navigation</span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
          <span class="icon-bar"></span>
        </button>
        
          
          <a class="navbar-brand-img" href="https://lubolab.com/">
            <img alt="Lubolab" src="https://lubolab.com/images/lubolablogo.png">
            
          </a>
        </div>
        <div id="navbar" class="collapse navbar-collapse">
          <ul class="nav navbar-nav navbar-right">
            
            
            <li class="">

              <a href="https://datalab.lubolab.com/" >
                <i class='fa fa-flask'></i>
                Datalab
              </a>
            </li>
            
            <li class="">

              <a href="https://github.com/lubomirkamensky/lubolab" >
                <i class='fa fa-github'></i>
                Blog Source code
              </a>
            </li>
            
            <li class="">

              <a href="https://twitter.com/LubomirKamensky" >
                <i class='fa fa-twitter'></i>
                Twitter
              </a>
            </li>
            
            
              
          </ul>
        </div>
        
      </div>
    </nav>
  </header>


<div class="container">
  <div class="row">
    <div class="col-sm-9">
      <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
  <div class="text-center">

    <h1>My Personal Data Warehouse Kickoff
</h1>

    <div class="metas">
<small>
  <i class="fa fa-calendar"></i>
  <time datetime="2017-01-12">12 Jan, 2017</time>
</small>


  <small>
  &middot; Read in about 4 min
  &middot; (787 words)
  &middot; 
<span class="share-box">Share this on:
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2flubolab.com%2fmy-personal-dwh-kickoff%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-facebook-official "></i></a>

    <a href="https://twitter.com/intent/tweet?text=My%20Personal%20Data%20Warehouse%20Kickoff&amp;url=https%3a%2f%2flubolab.com%2fmy-personal-dwh-kickoff%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-twitter"></i></a>

    <a href="https://plus.google.com/share?url=https%3a%2f%2flubolab.com%2fmy-personal-dwh-kickoff%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-google-plus"></i></a>

    <a href="http://www.reddit.com/submit?url=https%3a%2f%2flubolab.com%2fmy-personal-dwh-kickoff%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-reddit"></i></a>

    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2flubolab.com%2fmy-personal-dwh-kickoff%2f&amp;title=My%20Personal%20Data%20Warehouse%20Kickoff" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-linkedin"></i></a>

    <a href="mailto:?subject=My%20Personal%20Data%20Warehouse%20Kickoff&amp;body=Check out this site https%3a%2f%2flubolab.com%2fmy-personal-dwh-kickoff%2f" data-proofer-ignore=""><i class="fa fa-envelope"></i></a>
  </span>

  </small>

<div class="margin-10">
  <i class="fa fa-tags"></i>
  
  <a href="https://lubolab.com/tags/personal-dwh" class="label label-primary">Personal DWH</a>
  


</div>

<br>
</div>

  </div>
</div>

      <div class="content">
  

<h3 id="the-weather-station">The Weather Station</h3>

<p>It all started more than five years ago the day I decided to buy my very own weather station. I ended up with  <a href="http://en.lacrossetechnology.fr/P-5-A1-WS2800.html" target="_blank">La Crosse Technology WS-2800-IT</a>. You can still find it on a market under various brands like TFA, Techno line,..
<img src="https://lubolab.com/images/2017/01/la-crosse-technology-ws2800-pro.jpg" alt="" /></p>

<p>It  enables wireless data transmission to PC using USB stick,  which made it good candidate  for my future sensor network.</p>

<h3 id="the-local-server">The Local Server</h3>

<p>Of course I needed a local server collecting regularly the data and sending it to my virtual server in the cloud. The requirements were Windows OS and standard USB socket.</p>

<p>I picked for that one of the first MS Windows tablets <a href="http://www.trustedreviews.com/msi-windpad-100w-review" target="_blank">MSI WindPad 100W</a>.
Honestly, I can hardly imagine using it as tablet, but for a server it was quite good choice.
<img src="https://lubolab.com/images/2017/01/MSI-WindPad-100W-tablet.jpg" alt="" /></p>

<p>There is permanently running desktop app <a href="http://www.heavyweather.info/new_english_uk/2800software.html">Heavy Weather PRO</a> showing on the screen the data from the weather station.
<img src="https://lubolab.com/images/2017/01/HWP.png" alt="" />
Thanks to batteries it can easily run even during electricity failures without any impact on automated data flow.</p>

<h3 id="the-cloud-server">The Cloud Server</h3>

<p>I really want to use some nice Cloud SQL service but there is always good reason for postponing that. It is still much cheaper to rent some tiny Virtual Server and install MySQL on it. That&rsquo;s exactly my current setup for the cloud server. Using some base VPS from local provider here in Czechia, <a href="https://hosting.wedos.com/en/" target="_blank">Wedos</a></p>

<h3 id="the-data-flow">The Data Flow</h3>

<p>It is designed in such way so the process is fully automated and no manual interaction is needed including cases of:
<div class="c_alert c_alert-warning"><i class="fa fa-exclamation-triangle"></i>
<b>the standard risks :</b><br>
1. Weather station is disconnected and the source file cannot be updated<br>
2. Internet Connectivity is lost and the data cannot be sent to the cloud server
</div></p>

<p>To fix the first risk, it&rsquo;s necessary to avoid repetitive sending of the last available measuring from the station. A simple view can guarantee this.</p>

<p>To cover the second one, there is a local buffer accumulating the data until the internet gets reconnected.</p>

<p>So I ended up with the solution described on the picture below:</p>

<p><img src="https://lubolab.com/images/2017/01/WS-2800_DATA_LOAD2-3.png" alt="Data flow" /></p>

<p>There are 3 steps. The flow starts with the file <code>currdat.lst</code> generated by Heavy Weather PRO, the app mentioned earlier. The file is usually located at <code>C:\programData</code></p>

<p>Then data moves to SQL database, first transforming the file to actual data snapshot in a table and then incrementally building the history of weather measuring. The history is temporarily stored in the local buffer and then delivered to the final destination in the cloud server.</p>

<p>This is how the data looks in both local buffer and the cloud target (table weather_measuring):
<img src="https://lubolab.com/images/2017/01/table.png" alt="" /></p>

<h3 id="sql-platform">SQL Platform</h3>

<p>As database platform for both Local and Cloud server I use old good MySQL. Actually, I already switched to <a href="https://mariadb.org/" target="_blank">MariaDB</a>, recent fork of the MySQL. The main reason was that in MariaDB it is still possible to disable  innodb support which I don&rsquo;t need for my personal DWH. Later I started to like MariaDB also for other reasons.</p>

<h3 id="public-github-repository">Public GitHub Repository</h3>

<p>Definitions for mentioned database objects can be find in public repository on GitHub <a href="https://github.com/lubomirkamensky/personal_dwh" target="_blank">personal_dwh</a>
<code>personal_dwh/detail_layer/db</code></p>

<h3 id="the-etl-jobs">The (ETL) Jobs</h3>

<p>I split those 3 steps into <strong>2 jobs:
1. Weather load: Update current snapshot (step 1) and load local buffer (step 2)
2. Weather rupload: Load the cloud target and clean old data in the local buffer (step3)</strong></p>

<p>Each job is one short powershell script. Called through standard .bat file like
<code>powershell -command &quot;&amp; 'C:\personaldwh\weather_load.ps1' &quot;</code></p>

<p>All scripts are available also in the repository mentioned above:
<code>personal_dwh/detail_layer/jobs</code></p>

<p>The execution scheduling is done simply using Task scheduler.</p>

<p><img src="https://lubolab.com/images/2017/01/task.png" alt="" /></p>

<p>The first job is scheduled to be executed every minute. The plan for second job is to run each 10 minutes. If second job, for any reason, cannot connect to the cloud server, then the local buffer is just accumulating data. It can be few hours or even several days. The next execution after reconnecting will  catch up all missed loads.</p>

<p><div class="c_alert c_alert-success"><i class="fa fa-info-circle"></i> In case of local server replacement, I just reconnected the weather station to the new server with only job 1 enabled.
The old server is still running. Job 1 there is just hanging idle  without connection to the weather station. Job 2 finishes the data load to the cloud server.
After making sure that the new server is doing well and collecting weather data to the new local buffer,  I stop both jobs on the old server and finally start job 2 on the new server. </div></p>

<h3 id="opening-the-door-to-a-new-journey">Opening the Door to a New Journey</h3>

<p><div class="c_alert c_alert-success"><i class="fa fa-exclamation-triangle"></i> Now the very first table of the detail layer of my personal DWH is filled with data.</div> This is where the adventure really starts. Next time shortly about the target model of the whole detail layer and then let&rsquo;s start building data-marts, tools for adjustments, access layer, reports and perhaps even more.</p>

</div>


      <footer>
  
<span class="share-box">Share this on:
    <a href="https://www.facebook.com/sharer/sharer.php?u=https%3a%2f%2flubolab.com%2fmy-personal-dwh-kickoff%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-facebook-official "></i></a>

    <a href="https://twitter.com/intent/tweet?text=My%20Personal%20Data%20Warehouse%20Kickoff&amp;url=https%3a%2f%2flubolab.com%2fmy-personal-dwh-kickoff%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-twitter"></i></a>

    <a href="https://plus.google.com/share?url=https%3a%2f%2flubolab.com%2fmy-personal-dwh-kickoff%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-google-plus"></i></a>

    <a href="http://www.reddit.com/submit?url=https%3a%2f%2flubolab.com%2fmy-personal-dwh-kickoff%2f" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=900,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-reddit"></i></a>

    <a href="https://www.linkedin.com/shareArticle?mini=true&amp;url=https%3a%2f%2flubolab.com%2fmy-personal-dwh-kickoff%2f&amp;title=My%20Personal%20Data%20Warehouse%20Kickoff" onclick="window.open(this.href, 'mywin',
'left=20,top=20,width=500,height=500,toolbar=1,resizable=0'); return false;"><i class="fa fa-linkedin"></i></a>

    <a href="mailto:?subject=My%20Personal%20Data%20Warehouse%20Kickoff&amp;body=Check out this site https%3a%2f%2flubolab.com%2fmy-personal-dwh-kickoff%2f" data-proofer-ignore=""><i class="fa fa-envelope"></i></a>
  </span>

  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
      
  
    <nav><ul class="pager">
    

    
      <li class="next">
        <a href="https://lubolab.com/detail-layer-logical-data-model/" title="Detail Layer: Logical Data Model">
            Next <span aria-hidden="true">&rarr;</span>
        </a>
      </li>
    
    </ul> </nav>
  


</div>

  <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
  
<div id="disqus_thread"></div>
<script type="text/javascript">
  (function() {
    
    
    if (window.location.hostname == "localhost")
      return;

    var dsq = document.createElement('script'); dsq.async = true; dsq.type = 'text/javascript';
    dsq.src = '//lubolab.disqus.com/embed.js';
    (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
  })();
</script>
<noscript>Please enable JavaScript to view the <a href="http://disqus.com/?ref_noscript">comments powered by Disqus.</a></noscript>


</div>

</footer>

    </div>
    
      <div class="col-xs-12 col-sm-12 col-md-3 col-lg-3">
        <div>
  

    <div class="section">
      <header><div class="title"><b>Latest Posts</b></div></header>
      <div class="content">
        <ul>
        
          <li>
          <a href="https://lubolab.com/building-sensor-network-history/">Building Sensor Network: History layer using InfluxData</a>
          </li>
        
          <li>
          <a href="https://lubolab.com/building-sensor-network-sms/">Building Sensor Network: SMS gateway, Node-RED and smart alerts</a>
          </li>
        
          <li>
          <a href="https://lubolab.com/building-sensor-network-battery/">Building Sensor Network: Computer Battery Monitor</a>
          </li>
        
          <li>
          <a href="https://lubolab.com/building-sensor-network-neurio/">Building Sensor Network: Neurio integration</a>
          </li>
        
          <li>
          <a href="https://lubolab.com/building-sensor-network-futura/">Building Sensor Network: Jablotron Futura integration</a>
          </li>
        
          <li>
          <a href="https://lubolab.com/iot-doorbell-bc/">IoT Doorbell: with BigClown</a>
          </li>
        
          <li>
          <a href="https://lubolab.com/building-sensor-network-bc/">Building Sensor Network: with BigClown</a>
          </li>
        
          <li>
          <a href="https://lubolab.com/camera-events-the-etl/">Camera Events: The ETL</a>
          </li>
        
          <li>
          <a href="https://lubolab.com/camera-events-data-model/">Camera Events: Data Model</a>
          </li>
        
          <li>
          <a href="https://lubolab.com/new_setup_for_this_blog/">New setup for this blog: Migration from Ghost to Hugo</a>
          </li>
        
        </ul>
      </div>
    </div>

    
      
      
    
      
      
      <div class="section taxonomies">
        <header><div class="title"><b>tag</b></div></header>

        <div class="content">
          <ul>
            <li><a href="https://lubolab.com/tags/personal-dwh">personal-dwh</a></li><li><a href="https://lubolab.com/tags/bigclown">bigclown</a></li><li><a href="https://lubolab.com/tags/netatmo">netatmo</a></li><li><a href="https://lubolab.com/tags/battery-monitor2mqtt">battery-monitor2mqtt</a></li><li><a href="https://lubolab.com/tags/blogging-platform">blogging-platform</a></li><li><a href="https://lubolab.com/tags/futura">futura</a></li><li><a href="https://lubolab.com/tags/influxdata">influxdata</a></li><li><a href="https://lubolab.com/tags/jablotron">jablotron</a></li><li><a href="https://lubolab.com/tags/json2mqtt">json2mqtt</a></li><li><a href="https://lubolab.com/tags/modbus2mqtt">modbus2mqtt</a></li>
          </ul>
        </div>
      </div>
      
    
      
      
    

</div>

      </div>
    
  </div>
</div>
    
<footer class="footer hidden-print">
  <div class="container">
    <div class="row">
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12">
           <div class="pull-left">
  <a class="toplink" href="javascript:" id="return-to-top">back to top</a>
</div>
<div class="pull-right">

<a href="https://lubolab.com/"></a> <i>&middot;</i>

</div>

        </div>
        <div class="col-xs-12 col-sm-12 col-md-12 col-lg-12 text-center">
              
    

    
<div class="container copyright">
    <small>
  &copy; 2018 Lubolab

  </small>
</div>



        </div>
    </div>
  </div>
</footer>

    

<script src="https://lubolab.com/js/jquery.min.js"></script>
<script src="https://lubolab.com/js/bootstrap.min.js"></script>


<script src="https://lubolab.com/js/highlight.pack.js"></script>
<script src="https://lubolab.com/js/site.js"></script>
<script>hljs.initHighlightingOnLoad();</script>


<script>
  var _gaq=[['_setAccount','UA-90639023-1'],['_trackPageview']];
  (function(d,t){var g=d.createElement(t),s=d.getElementsByTagName(t)[0];
  g.src=('https:'==location.protocol?'//ssl':'//www')+'.google-analytics.com/ga.js';
  s.parentNode.insertBefore(g,s)}(document,'script'));
</script>

<script>
var ENABLE_POPOVER =  false , 
EXPIRE_COOKIE =  5 , 
SHOW_MODAL_TIMEOUT =  10000 , 
MOUSE_LEAVE =  true , 
MODAL_SIZE = "", 
POST_URL = "https://zapier.com/hooks/catch/1227563/", 
SIGNUP_HEADER = "Join Our Newsletter",
HEADER_IMAGE = "//placehold.it/1000x600",
IMG_DESCRIPTION = "Placeholder image for this popover modal optin form",
SIGNUP_TEXT = "Signup today for free and be the first to get notified on new updates.",
INPUT_PLACEHOLDER = "Enter your email",
SUBMIT_BUTTON = "Subscribe",
SUCCESS_MESSAGE = "Thanks for your subscription!",
ERROR_MESSAGE = "Submitting form failed!",
OPTIN =  true ,
COOKIE_NAME = "mycookie1",
CONTENTLANGUAGE = ""; 
</script>





<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js"></script>
<script type="text/javascript"
        src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/config/TeX-AMS-MML_HTMLorMML.js"></script>

<script type="text/x-mathjax-config">
MathJax.Hub.Config({
  tex2jax: {
    inlineMath: [['$','$'], ['\\(','\\)']],
    displayMath: [['$$','$$'], ['\[','\]']],
    processEscapes: true,
    processEnvironments: true,
    skipTags: ['script', 'noscript', 'style', 'textarea', 'pre'],
    TeX: { equationNumbers: { autoNumber: "AMS" },
         extensions: ["AMSmath.js", "AMSsymbols.js"] }
  }
});
</script>

<script type="text/x-mathjax-config">
  MathJax.Hub.Queue(function() {
    for(var all in MathJax.Hub.getAllJax()) {
        all.SourceElement().parentNode.className += ' has-jax';

    }
});
</script>






  </body>
</html>

